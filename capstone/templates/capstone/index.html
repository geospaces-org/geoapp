{% extends "common.html" %}
{% load custom_tags %}
{% block content %}
<script src="/static/geoui/splitter.js"></script>
<link href="/static/geoui/jquery-tabs.css" rel="stylesheet" />
<link href="/static/geoui/slidermenu.css" rel="stylesheet" />
<script src="/static/geoui/slidermenu.js"></script>
<script src="/static/bower_components/simplemde/debug/simplemde.js"></script>
<!-- ---------------------------------------------------
    SIDEBAR STYLE
----------------------------------------------------- -->
<style>
.tab-details {
    background-color: white;
    border-radius: 4px 4px 0 0 ;
    border: 0px solid rgba(50, 50, 93, 0.1);

    height: fit-content;
    overflow: auto;
    padding-top: 30px;
    padding-left: 50px;
    text-align: left;
}
.tab-content {
    text-align: initial;
    max-width: 800px;
    display: contents;
    overflow: auto;
}

.leftpane {
    width: 270px;
    height: 90%;
    overflow-y: auto;
    overflow-x:scroll;
    background: #f9f9f9;
}

@media only screen and (max-width: 600px) {
    .nmenu {
        width: 50px !important;
    }
}
</style>
<!-- ---------------------------------------------------
    HTML 
----------------------------------------------------- -->
<div id="workspace">
<div id="leftPane" class="leftpane scroller ">
<ss id="newmenu" class="scroller" style="";>
</ss>
</div>
  <div id="rightPane" style="padding: 0px; margin: 0px;">
    <div id="topPane" style="width: 100%; height:100px;text-align: center;">
        <br/><h4> <i class="fas fa-graduation-cap"></i> Capstone project list for your Class</h4>
        <input type="text"  id="capid" style="height:40px;width: 50%" >
    </div>
    <div id="bottomPane" style="width: 100%; height:100%; background: #f9f9f9;">
        <div style="height: 190px;width: 100%; background-size:100% 100%;
              background-image:url(/static/media/cap/houseprice.png);
              "
        >
        <br/><br/>
        </div>

        <div id="tabs" class=tabs style=";border: 0px; border-left: 1px solid #f7f7f7">
            <ul>
                <li><a href="#tabs-overview"  >Overview</a></li>
                <li><a href="#tabs-data"      >Data</a></li>
                <li><a href="#tabs-solution"  >Solutions</a></li>
                <li><a href="#tabs-disc"      >Discussions</a></li>
            </ul>
            <div style="width:100%; height: 1px; background: #efefef"> </div>
            <div class="tab-details" style="width: 80%;" >
                <div id="tabs-overview" class="tab-content" >Overview</div>
                <div id="tabs-data"     class="tab-content" >Data</div>
                <div id="tabs-solution" class="tab-content" >Code</div>
                <div id="tabs-disc"     class="tab-content" >Not Implemented! Coming soon</div>
            </div>
        </div>
    </div>
  </div>
</div>
<style>
</style>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    SCRIPTS
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<script>
function getcapstoneSidebarCB(responseTxt, statusTxt, xhr){
    if (JS_error(responseTxt, statusTxt, xhr, true) ) {
        return;
    }
    getmenu(responseTxt, '#newmenu', "Capstones")
}
function getcapstoneSidebar(){
    callws("/capstone/capmenu/", null, getcapstoneSidebarCB)
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
simplemde = null
function md2html(val, ext, div){
    if (!simplemde)
        simplemde = new SimpleMDE({element: null });

    var html  = simplemde.markdown(val);
    if ( div )
        $(div).html(ext + html)
    return html
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
function showCapstoneProjectCB(responseTxt, statusTxt, xhr){
    if (JS_error(responseTxt, statusTxt, xhr, true) ) {
        return;
    }
    ret = JSON.parse(responseTxt);

    f = $('#capid').val()
    var edito = editd = edits = editi = "";
    var href = "/blogs/secured/create_article.html/?file=/capstone/capstone/"+ f;
    /*
    if ({{ request.user|has_group:"editcapstone"}}){
        edito = `<a style="float:right;color: #fff" class="btn btn-secondary" target="cap"href="${href}/README.md"    ><i class="fas fa-edit"></i> Edit</a>`
        editd = `<a style="float:right;color: #fff" class="btn btn-secondary" target="cap"href="${href}/data.md"      ><i class="fas fa-edit"></i> Edit</a>`
        edits = `<a style="float:right;color: #fff" class="btn btn-secondary" target="cap"href="${href}/solutions.md" ><i class="fas fa-edit"></i> Edit</a>`
        editi = `<a style="float:right;color: #fff" class="btn btn-secondary" target="cap"href="${href}/discuss.md"   ><i class="fas fa-edit"></i> Edit</a>`
    }
    */
    //salert(`<i class='fa fa-spinner fa-spin' style='font-size: 48px;color:red;'></i> `, "btn-warning")
    md2html(ret.overview,    edito, '#tabs-overview')
    md2html(ret.data,        editd, '#tabs-data'    )
    md2html(ret.solutions,   edits, '#tabs-solution')
    md2html(ret.discussions, editi, '#tabs-disc'    )
}
function showCapstoneProject(f){
    f = f || $('#capid').val()
    if (!f){
        return;
    }
    $('#capid').val(f)
    const URL1  = `/capstone/getcapstone/?q=${f}`
    callws(URL1, null, showCapstoneProjectCB )
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
function myMenuItemClicked(f, a){
    $('#capid').val(f)
    showCapstoneProject(f)

    menusetActive(a)
    //window.location = window.location.href.split('?')[0]+ `?q=${f}`
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
$(function () {
    $("#workspace").splitter({
        orientation: "horizontal",
        limit: 50,
        barwidth: 2,
    });
    $("#rightPane").splitter({
        orientation: "vertical",
        limit: 100,
        barwidth: 2,
    });
});
$(document).ready(function() {
    $(window).resize()
    menuItemClicked = myMenuItemClicked
    getcapstoneSidebar();

    var urlp = new URL(window.location.href)
    showCapstoneProject( urlp.searchParams.get('q') )
})
</script>
{% endblock %}
